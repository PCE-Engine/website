var e=[],c=(document.querySelector("#chess-board").parentElement.clientWidth-25)/18;window.onresize=t=>{c=(document.querySelector("#chess-board").parentElement.clientWidth-25)/18;for(let a=0;a<e.length;a++)for(let l=0;l<e[a].length;l++)e[a][l].style.width=`${2*c}px`,e[a][l].style.height=`${2*c}px`};var L,O,b,A,h,y,w,u,n,o,p=-1,d=-1,r,s,f=[],g=!0;function m(t){(g&&(Array.prototype.indexOf.call(t.target.classList,"wr")>=0||Array.prototype.indexOf.call(t.target.classList,"wn")>=0||Array.prototype.indexOf.call(t.target.classList,"wb")>=0||Array.prototype.indexOf.call(t.target.classList,"wq")>=0||Array.prototype.indexOf.call(t.target.classList,"wk")>=0||Array.prototype.indexOf.call(t.target.classList,"wp")>=0)||!g&&!(Array.prototype.indexOf.call(t.target.classList,"wr")>=0||Array.prototype.indexOf.call(t.target.classList,"wn")>=0||Array.prototype.indexOf.call(t.target.classList,"wb")>=0||Array.prototype.indexOf.call(t.target.classList,"wq")>=0||Array.prototype.indexOf.call(t.target.classList,"wk")>=0||Array.prototype.indexOf.call(t.target.classList,"wp")>=0))&&t.which==1&&(s&&(s.style.boxShadow=""),r=t.target,b=t.clientX,A=t.clientY,L=t.offsetX,O=t.offsetY,r.style.position="absolute",r.style.left=`${t.clientX-c}px`,r.style.top=`${t.clientY-c}px`,r.style.height=`${2*c}px`,r.style.width=`${2*c}px`,s=t.target.parentElement,s.style.boxShadow="inset 0 0 0 3px #94d678")}function S(t){if(g&&(Array.prototype.indexOf.call(t.target.classList,"wr")>=0||Array.prototype.indexOf.call(t.target.classList,"wn")>=0||Array.prototype.indexOf.call(t.target.classList,"wb")>=0||Array.prototype.indexOf.call(t.target.classList,"wq")>=0||Array.prototype.indexOf.call(t.target.classList,"wk")>=0||Array.prototype.indexOf.call(t.target.classList,"wp")>=0)||!g&&!(Array.prototype.indexOf.call(t.target.classList,"wr")>=0||Array.prototype.indexOf.call(t.target.classList,"wn")>=0||Array.prototype.indexOf.call(t.target.classList,"wb")>=0||Array.prototype.indexOf.call(t.target.classList,"wq")>=0||Array.prototype.indexOf.call(t.target.classList,"wk")>=0||Array.prototype.indexOf.call(t.target.classList,"wp")>=0)){s&&(s.style.boxShadow=""),r=t.target,b=t.touches[0].clientX,A=t.touches[0].clientY;let a=t.target.getBoundingClientRect();L=t.touches[0].clientX-window.pageXOffset-a.left,O=t.touches[0].clientY-window.pageYOffset-a.top,r.style.position="absolute",r.style.left=`${b-c}px`,r.style.top=`${A-c}px`,r.style.height=`${2*c}px`,r.style.width=`${2*c}px`,s=t.target.parentElement,s.style.boxShadow="inset 0 0 0 3px #94d678"}}function X(t){let a=t.target;t.target.tagName=="DIV"&&(a=a.parentElement);let l=Array.prototype.indexOf.call(f,a);if(l>=0)f.splice(l,1),a.style.background="";else{a.style.background="#db4e2c";let i=Array.prototype.indexOf.call(a.parentNode.children,a)-1,x=Math.abs(Array.prototype.indexOf.call(a.parentNode.parentNode.children,a.parentNode)+9)-9;i%2==x%2&&(a.style.background="#f06948"),f.push(a)}}function Y(t){if(t.target.children.length==0&&t.target.tagName!="DIV")for(;f.length>0;)f[0].style.background="",f.shift()}window.onmouseup=()=>{if(r&&(r.style.position="initial",r.style.height="",r.style.width=""),r&&(n!=w||o!=u)&&e.length-o-1<e.length&&e.length-o-1>=0&&n<e[e.length-o-1].length&&n>=0){for(r.parentElement.removeChild(r),e[e.length-o-1][n].innerHTML="",e[e.length-o-1][n].appendChild(r),s&&(s.style.boxShadow="");f.length>0;)f[0].style.background="",f.shift();g=!g}r=null,e[e.length-d-1][p].style.boxShadow="",[o,n,u,w,d,p]=[0,0,0,0,0,0]};window.ontouchend=()=>{if(r&&(r.style.position="initial",r.style.height="",r.style.width=""),r&&(n!=w||o!=u)&&e.length-o-1<e.length&&e.length-o-1>=0&&n<e[e.length-o-1].length&&n>=0){for(r.parentElement.removeChild(r),e[e.length-o-1][n].innerHTML="",e[e.length-o-1][n].appendChild(r),s&&(s.style.boxShadow="");f.length>0;)f[0].style.background="",f.shift();g=!g}r=null,e[e.length-d-1][p].style.boxShadow="",[o,n,u,w,d,p]=[0,0,0,0,0,0]};window.ontouchmove=t=>{if(r!=null){r.style.left=`${t.touches[0].clientX-c}px`,r.style.top=`${t.touches[0].clientY-c}px`,h=(b-t.touches[0].clientX-L)/(c*2),h>0&&h++,y=(A-t.touches[0].clientY-O)/(c*2),y>0&&y++,h=parseInt(h),y=parseInt(y);let a=Array.prototype.indexOf.call(s.parentNode.children,s)-1,l=Math.abs(Array.prototype.indexOf.call(s.parentNode.parentNode.children,s.parentNode)+9)-9;o=l-y,n=a-h,w=a,u=l,p!=-1&&d!=-1&&(e.length-d-1>=0&&e.length-d-1<e.length&&p>=0&&p<e[e.length-d-1].length&&(e[e.length-d-1][p].style.boxShadow=""),e.length-o-1>=0&&e.length-o-1<e.length&&n>=0&&n<e[e.length-o-1].length&&(e[e.length-o-1][n].style.boxShadow="inset 0 0 0 3px #78acd6"),s.style.boxShadow="inset 0 0 0 3px #94d678"),p=n,d=o}};window.onmousemove=t=>{if(r!=null){r.style.left=`${t.clientX-c}px`,r.style.top=`${t.clientY-c}px`,h=(b-t.clientX-L)/(c*2),h>0&&h++,y=(A-t.clientY-O)/(c*2),y>0&&y++,h=parseInt(h),y=parseInt(y);let a=Array.prototype.indexOf.call(s.parentNode.children,s)-1,l=Math.abs(Array.prototype.indexOf.call(s.parentNode.parentNode.children,s.parentNode)+9)-9;o=l-y,n=a-h,w=a,u=l,p!=-1&&d!=-1&&(e.length-d-1>=0&&e.length-d-1<e.length&&p>=0&&p<e[e.length-d-1].length&&(e[e.length-d-1][p].style.boxShadow=""),e.length-o-1>=0&&e.length-o-1<e.length&&n>=0&&n<e[e.length-o-1].length&&(e[e.length-o-1][n].style.boxShadow="inset 0 0 0 3px #78acd6"),s.style.boxShadow="inset 0 0 0 3px #94d678"),p=n,d=o}};window.onload=()=>{let t=document.querySelector("tbody"),a=t.querySelectorAll("div");t.querySelectorAll("th").forEach(l=>{l.addEventListener("mousedown",i=>{i.preventDefault&&i.preventDefault()}),l.addEventListener("touchstart",i=>{i.preventDefault&&i.preventDefault()})}),t.querySelectorAll("td").forEach(l=>{l.addEventListener("mousedown",i=>{i.preventDefault&&i.preventDefault()}),l.addEventListener("touchstart",i=>{i.preventDefault&&i.preventDefault()})});for(let l=0;l<a.length;l++)a[l].addEventListener("mousedown",i=>{m(i)}),a[l].addEventListener("touchstart",i=>{S(i)});for(let l=0;l<t.children.length-1;l++){e.push([]);for(let i=1;i<t.children[l].children.length;i++)e[e.length-1].push(t.children[l].children[i]),t.children[l].children[i].addEventListener("contextmenu",x=>{x.preventDefault(),X(x)}),t.children[l].children[i].addEventListener("click",x=>{Y(x)})}e=e.reverse();for(let l=0;l<e.length;l++)for(let i=0;i<e[l].length;i++)e[l][i].style.width=`${2*c}px`,e[l][i].style.height=`${2*c}px`};
